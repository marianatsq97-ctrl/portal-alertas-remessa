<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Portal de Alertas – Remessas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
:root{
  --bg-dark:#050814;
  --bg-card:#0b1020;
  --accent:#ff8c1a;
  --ok:#22c55e;
  --warn:#facc15;
  --grave:#fb923c;
  --action:#ef4444;
  --text:#f5f7ff;
  --muted:#9aa0ff;
}

*{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto}
body{
  margin:0;
  min-height:100vh;
  background:radial-gradient(circle at top,#1a1d2a 0,#050814 60%);
  color:var(--text);
}

/* ===== LOGIN ===== */
#login{
  display:flex;
  align-items:center;
  justify-content:center;
  min-height:100vh;
}

.login-card{
  width:420px;
  background:linear-gradient(180deg,#0b1020,#060914);
  border-radius:20px;
  padding:40px;
  box-shadow:0 40px 80px rgba(0,0,0,.6);
  text-align:center;
}

.login-logo{
  width:140px;
  height:140px;
  margin:0 auto 20px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.login-logo img{
  width:100%;
  filter:drop-shadow(0 0 25px rgba(255,255,255,.15));
}

.login-card h1{
  margin:0;
  font-size:28px;
}

.login-card p{
  color:var(--muted);
  margin:8px 0 24px;
}

.login-card input{
  width:100%;
  padding:14px;
  margin-bottom:14px;
  border-radius:12px;
  border:none;
  background:#050814;
  color:white;
  font-size:15px;
}

.login-card button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  background:var(--accent);
  color:#000;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
}

/* ===== APP ===== */
#app{display:none;padding:30px}

header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom:30px;
}

.header-left{
  display:flex;
  align-items:center;
  gap:18px;
}

.header-left img{
  width:60px;
  filter:drop-shadow(0 0 15px rgba(255,255,255,.15));
}

header h2{margin:0}

.badge{
  padding:8px 14px;
  border-radius:20px;
  background:#101629;
  border:1px solid #1f2a55;
}

button{
  background:#101629;
  color:white;
  border:1px solid #1f2a55;
  border-radius:14px;
  padding:10px 16px;
  cursor:pointer;
}

button.primary{
  background:var(--accent);
  color:#000;
  border:none;
  font-weight:700;
}

.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
}

.card{
  background:linear-gradient(180deg,#0b1020,#050814);
  border-radius:18px;
  padding:20px;
  position:relative;
}

.card.ok{border-left:5px solid var(--ok)}
.card.warn{border-left:5px solid var(--warn)}
.card.grave{border-left:5px solid var(--grave)}
.card.action{border-left:5px solid var(--action)}

.card h3{margin:0;font-size:16px}
.card span{font-size:34px;font-weight:800}

.section{
  margin-top:30px;
  background:linear-gradient(180deg,#0b1020,#050814);
  border-radius:18px;
  padding:20px;
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:14px;
}

th,td{
  padding:12px;
  border-bottom:1px solid #1f2a55;
  text-align:left;
}

th{
  background:var(--accent);
  color:#000;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
  <div class="login-card">
    <div class="login-logo">
      <img src="logo-areia-ana.png" alt="Areia Ana">
    </div>
    <h1>Portal de Alertas</h1>
    <p>Remessas • Contratos • Status automático</p>

    <input id="user" placeholder="Usuário">
    <input id="pass" type="password" placeholder="Senha">
    <button onclick="login()">Entrar</button>
  </div>
</div>

<!-- APP -->
<div id="app">
  <header>
    <div class="header-left">
      <img src="logo-areia-ana.png">
      <h2>Portal de Alertas – Remessas</h2>
    </div>
    <div style="display:flex;gap:12px;align-items:center">
      <span id="perfil" class="badge"></span>
      <button onclick="logout()">Sair</button>
    </div>
  </header>

  <div class="cards">
    <div class="card ok"><h3>OK</h3><span id="ok">0</span></div>
    <div class="card warn"><h3>Atenção</h3><span id="warn">0</span></div>
    <div class="card grave"><h3>Atenção Grave</h3><span id="grave">0</span></div>
    <div class="card action"><h3>Plano de Ação</h3><span id="action">0</span></div>
  </div>

  <div id="adminArea" class="section" style="display:none">
    <h3>Administração</h3>
    <input type="file" id="file">
    <button class="primary" onclick="importar()">Importar</button>
    <button onclick="limpar()">Excluir Dados</button>
  </div>

  <div class="section">
    <h3>Detalhamento</h3>
    <table>
      <thead>
        <tr>
          <th>Cliente</th>
          <th>Contrato</th>
          <th>Vendedor</th>
          <th>Traço</th>
          <th>Última Remessa</th>
          <th>Dias</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</div>

<script>
const USERS={
  admin:{pass:"1234",role:"Administrador"},
  usuario:{pass:"1234",role:"Usuário"}
};

let perfil=null;
let dados=JSON.parse(localStorage.getItem("dados")||"[]");

function login(){
  const u=user.value;
  const p=pass.value;
  if(!USERS[u]||USERS[u].pass!==p) return alert("Login inválido");
  perfil=USERS[u].role;
  document.getElementById("login").style.display="none";
  document.getElementById("app").style.display="block";
  document.getElementById("perfil").innerText="Perfil: "+perfil;
  if(perfil==="Administrador") adminArea.style.display="block";
  render();
}

function logout(){
  location.reload();
}

function importar(){
  const f=file.files[0];
  if(!f) return;
  const r=new FileReader();
  r.onload=e=>{
    const linhas=e.target.result.split("\n").slice(1);
    dados=linhas.map(l=>{
      const c=l.split(";");
      return {
        cliente:c[0],
        contrato:c[1],
        vendedor:c[2],
        traco:c[3],
        data:c[4]
      };
    });
    localStorage.setItem("dados",JSON.stringify(dados));
    render();
  };
  r.readAsText(f);
}

function limpar(){
  if(confirm("Excluir todos os dados?")){
    localStorage.removeItem("dados");
    dados=[];
    render();
  }
}

function render(){
  let ok=0,w=0,g=0,a=0;
  tbody.innerHTML="";
  dados.forEach(d=>{
    const dias=Math.floor((Date.now()-new Date(d.data))/(1000*60*60*24));
    let s="OK",cls="ok";
    if(dias>21){s="Plano de Ação";cls="action";a++}
    else if(dias>14){s="Atenção Grave";cls="grave";g++}
    else if(dias>7){s="Atenção";cls="warn";w++}
    else ok++;

    tbody.innerHTML+=`
      <tr>
        <td>${d.cliente}</td>
        <td>${d.contrato}</td>
        <td>${d.vendedor}</td>
        <td>${d.traco}</td>
        <td>${d.data}</td>
        <td>${dias}</td>
        <td>${s}</td>
      </tr>`;
  });
  ok.innerText=ok; warn.innerText=w; grave.innerText=g; action.innerText=a;
}
</script>

</body>
</html>
