<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Portal de Alertas - Remessas</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>

<body>

<script>
const role = localStorage.getItem("role");
if(role !== "admin" && role !== "user"){
  localStorage.removeItem("role");
  window.location.href="login.html";
}
</script>

<header class="topbar">
  <div class="logo-area">
    <img src="logo-areia-ana.png" class="logo-header">
    <h2>Portal de Alertas - Remessas</h2>
  </div>

  <button class="logout-btn" onclick="logout()">Sair</button>
</header>

<main class="content">

<div id="adminPanel">

  <input type="file" id="fileInput" accept=".xlsx">
  <button id="loadFileBtn">Carregar arquivo</button>
  <button id="clearBtn">Excluir dados</button>

  <div id="statusMsg"></div>

</div>

<h3>Resumo</h3>

<div class="kpis">
  <div>Contratos: <span id="kpiContracts">0</span></div>
  <div>Clientes: <span id="kpiClients">0</span></div>
  <div>Volume: <span id="kpiVolume">0</span></div>
</div>

<table>
<thead>
<tr>
<th>CNPJ</th>
<th>Contrato</th>
<th>Obra</th>
<th>Volume</th>
<th>Ãšltima remessa</th>
<th>Dias</th>
<th>Status</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

<div id="buildInfo"></div>

</main>

<script src="app.js"></script>

<script>
function logout(){
  localStorage.removeItem("role");
  window.location.href="login.html";
}
</script>

</body>
</html>
